<!doctype html><html lang=en dir=auto data-theme=dark><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Processing in Power Automate >5000 rows | _techguy</title><meta name=keywords content="powerautomate,dev,automation"><meta name=description content="What we want to achieve?
Power Automate from Microsoft is a powerful automation tool. It allows you to really simplify your work by creating a flow that will process large amounts of data. Thanks to the schedule option, all the work can be done at night, and in the morning, when you sit down to work, you have the finished result.
The problem is that right from the start, we encounter a significant limitation that, at first glance, may completely disqualify the further use of Power Automate—the limit on the amount of data we can process. While this is not so critical in the case of an SQL database, for Excel, which remains the most popular database in most companies, it is a disqualification right from the start."><meta name=author content="B"><link rel=canonical href=https://bgracz.github.io/posts/power-automate-batch-processing/><link crossorigin=anonymous href=/assets/css/stylesheet.11c11881f5e0d39ef83c3725410857a554d16f60d621bb0f91522c64ce5c7f0a.css integrity="sha256-EcEYgfXg0574PDclQQhXpVTRb2DWIbsPkVIsZM5cfwo=" rel="preload stylesheet" as=style><link rel=icon href=https://bgracz.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://bgracz.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bgracz.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://bgracz.github.io/apple-touch-icon.png><link rel=mask-icon href=https://bgracz.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://bgracz.github.io/posts/power-automate-batch-processing/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://bgracz.github.io/posts/power-automate-batch-processing/"><meta property="og:site_name" content="_techguy"><meta property="og:title" content="Processing in Power Automate >5000 rows"><meta property="og:description" content="What we want to achieve? Power Automate from Microsoft is a powerful automation tool. It allows you to really simplify your work by creating a flow that will process large amounts of data. Thanks to the schedule option, all the work can be done at night, and in the morning, when you sit down to work, you have the finished result.
The problem is that right from the start, we encounter a significant limitation that, at first glance, may completely disqualify the further use of Power Automate—the limit on the amount of data we can process. While this is not so critical in the case of an SQL database, for Excel, which remains the most popular database in most companies, it is a disqualification right from the start."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-01-12T08:55:13+01:00"><meta property="article:modified_time" content="2026-01-12T08:55:13+01:00"><meta property="article:tag" content="Powerautomate"><meta property="article:tag" content="Dev"><meta property="article:tag" content="Automation"><meta property="og:image" content="https://bgracz.github.io/posts/power-automate-batch-processing/cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bgracz.github.io/posts/power-automate-batch-processing/cover.png"><meta name=twitter:title content="Processing in Power Automate >5000 rows"><meta name=twitter:description content="What we want to achieve?
Power Automate from Microsoft is a powerful automation tool. It allows you to really simplify your work by creating a flow that will process large amounts of data. Thanks to the schedule option, all the work can be done at night, and in the morning, when you sit down to work, you have the finished result.
The problem is that right from the start, we encounter a significant limitation that, at first glance, may completely disqualify the further use of Power Automate—the limit on the amount of data we can process. While this is not so critical in the case of an SQL database, for Excel, which remains the most popular database in most companies, it is a disqualification right from the start."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bgracz.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Processing in Power Automate \u003e5000 rows","item":"https://bgracz.github.io/posts/power-automate-batch-processing/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Processing in Power Automate \u003e5000 rows","name":"Processing in Power Automate \u003e5000 rows","description":"What we want to achieve? Power Automate from Microsoft is a powerful automation tool. It allows you to really simplify your work by creating a flow that will process large amounts of data. Thanks to the schedule option, all the work can be done at night, and in the morning, when you sit down to work, you have the finished result.\nThe problem is that right from the start, we encounter a significant limitation that, at first glance, may completely disqualify the further use of Power Automate—the limit on the amount of data we can process. While this is not so critical in the case of an SQL database, for Excel, which remains the most popular database in most companies, it is a disqualification right from the start.\n","keywords":["powerautomate","dev","automation"],"articleBody":"What we want to achieve? Power Automate from Microsoft is a powerful automation tool. It allows you to really simplify your work by creating a flow that will process large amounts of data. Thanks to the schedule option, all the work can be done at night, and in the morning, when you sit down to work, you have the finished result.\nThe problem is that right from the start, we encounter a significant limitation that, at first glance, may completely disqualify the further use of Power Automate—the limit on the amount of data we can process. While this is not so critical in the case of an SQL database, for Excel, which remains the most popular database in most companies, it is a disqualification right from the start.\nBut is that really the case? Read on to find out more, as we break down this problem and try to find a solution!\nWhere does this restriction come from? Power Automate limits the “List rows present in a table” (Excel Online) action to 5,000 rows by default due to pagination policy and license limits to prevent Microsoft Graph API overload and excessive resource consumption. In practice, only 256 rows are loaded by default, but we can increase the limit to 5000 in the pagination settings. A higher value will cause an error, and the result of the action will remain the first 5000 records.\nSo what are we going to do about it? Let’s take a look at a graph that illustrates an example flow (simplified, of course, without data processing; we only want to understand the logic).\nWe have a trigger that starts the flow—an action has occurred, or we have simply set it to run at a specific time.\nWe create an integer variable with an initial value of 0.\nRight after the SkipToken variable, we create another one, of type Array, with an initial value of [] and call it resultsArray. This variable will store all our data from each batch.\nWe will iterate the loop n * 5000 until the amount of returned data falls below 5000 elements.\n1 less(length(body('Get_items')?'value'), 5000) and in the loop:\nthe Data action, i.e., connecting to our file, from which we will read. We must remember to find the Skip count option in advanced mode and assign it a value from the skipToken variable. The easiest way to do this is as follows: variablem('skipToken') after the first loop, where we collected the first batch of data, we need to calculate the point at which we will start the next loop. So we increase the value of skipToken by another 5000. 1 add(varaibles('skipToken'), 5000) we don’t want to lose the data collected in the current run, so we “send” it outside the loop - we combine what we currently have in resultArray with the data we have just obtained - MergeCurrentLoopWithResultsArray 1 union(variables('resultArray), outputs('newData')?['body']) and here is the correct dump to resultsArray from the UpdateResults step 1 outputs('MergeCurrentLoopWithResultsArray') What else is worth to do? I definitely recommend modifying the Timeout value for the Data step/action, i.e., where we refer to our Excel file. Keep in mind that in this approach, we focused on loading \u003e5000 rows, completely ignoring the number of columns, which can have a significant impact on data processing time.\nHow does it work? PT1H is a standard ISO 8601 format meaning 1 hour (Period/Time: 1 Hour). It is used in Power Automate as the default timeout for the Do until loop - it means the maximum time the loop can run - after 1 hour, the operation ends automatically, even if the condition is not met (60 iterations OR PT1H by default).\n1 2 3 PT10M // 10 minutes testing PT2H // 2 hours production P1D // 1 day (maximum for some actions) I recommend experimenting with this. PT2H seems to be safe for starters.\nAlso, remember to add a step at the end that will save our resultsArray to an xlsx, csv, or my favorite - json file, so that you don’t lose your data and can continue working with it!\n","wordCount":"682","inLanguage":"en","image":"https://bgracz.github.io/posts/power-automate-batch-processing/cover.png","datePublished":"2026-01-12T08:55:13+01:00","dateModified":"2026-01-12T08:55:13+01:00","author":{"@type":"Person","name":"B"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bgracz.github.io/posts/power-automate-batch-processing/"},"publisher":{"@type":"Organization","name":"_techguy","logo":{"@type":"ImageObject","url":"https://bgracz.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://bgracz.github.io/ accesskey=h title="_techguy (Alt + H)">_techguy</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://bgracz.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://bgracz.github.io/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://bgracz.github.io/about/ title="About me"><span>About me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Processing in Power Automate >5000 rows</h1><div class=post-meta><span title='2026-01-12 08:55:13 +0100 +0100'>January 12, 2026</span>&nbsp;·&nbsp;<span>4 min</span>&nbsp;·&nbsp;<span>B</span></div></header><figure class=entry-cover><img loading=eager srcset='https://bgracz.github.io/posts/power-automate-batch-processing/cover_hu_238b6b9997e11495.png 360w,https://bgracz.github.io/posts/power-automate-batch-processing/cover_hu_d54a62b86381cd4a.png 480w,https://bgracz.github.io/posts/power-automate-batch-processing/cover_hu_40235d988a401887.png 720w,https://bgracz.github.io/posts/power-automate-batch-processing/cover.png 800w' src=https://bgracz.github.io/posts/power-automate-batch-processing/cover.png sizes="(min-width: 768px) 720px, 100vw" width=800 height=366 alt="Power automate - header"></figure><div class=post-content><h1 id=what-we-want-to-achieve>What we want to achieve?<a hidden class=anchor aria-hidden=true href=#what-we-want-to-achieve>#</a></h1><p><strong>Power Automate</strong> from Microsoft is a powerful automation tool. It allows you to really simplify your work by creating a flow that will process large amounts of data. Thanks to the <em>schedule</em> option, all the work can be done at night, and in the morning, when you sit down to work, you have the finished result.</p><p>The problem is that right from the start, we encounter a significant limitation that, at first glance, may completely disqualify the further use of Power Automate—the limit on the amount of data we can process. While this is not so critical in the case of an <strong>SQL</strong> database, for <strong>Excel</strong>, which remains the most popular <em>database</em> in most companies, it is a disqualification right from the start.</p><p>But is that really the case? Read on to find out more, as we break down this problem and try to find a solution!</p><h1 id=where-does-this-restriction-come-from>Where does this restriction come from?<a hidden class=anchor aria-hidden=true href=#where-does-this-restriction-come-from>#</a></h1><p><strong>Power Automate</strong> limits the “List rows present in a table” (Excel Online) action to 5,000 rows by default due to pagination policy and license limits to prevent Microsoft Graph API overload and excessive resource consumption.
In practice, only <strong>256</strong> rows are loaded by default, but we can increase the limit to <strong>5000</strong> in the pagination settings. A higher value will cause an error, and the result of the action will remain the first 5000 records.</p><h1 id=so-what-are-we-going-to-do-about-it>So what are we going to do about it?<a hidden class=anchor aria-hidden=true href=#so-what-are-we-going-to-do-about-it>#</a></h1><p>Let&rsquo;s take a look at a graph that illustrates an example flow (simplified, of course, without data processing; we only want to understand the logic).</p><p><div style="text-align:center;margin:1em 0"><img src=/posts/test/diagram.png#center#50 alt="Visualization of process" style=width:50%;height:auto;border-radius:8px;display:inline-block></div></p><ol><li><p>We have a trigger that starts the flow—an action has occurred, or we have simply set it to run at a specific time.</p></li><li><p>We create an integer variable with an initial value of 0.</p></li><li><p>Right after the <strong>SkipToken</strong> variable, we create another one, of type Array, with an initial value of <em>[]</em> and call it <strong>resultsArray</strong>. This variable will store all our data from each batch.</p></li><li><p>We will iterate the loop <strong>n * 5000</strong> until the amount of returned data falls below 5000 elements.</p></li></ol><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>less</span>(<span style=color:#a6e22e>length</span>(<span style=color:#a6e22e>body</span>(<span style=color:#e6db74>&#39;Get_items&#39;</span>)<span style=color:#f92672>?</span><span style=color:#e6db74>&#39;value&#39;</span>), <span style=color:#ae81ff>5000</span>)
</span></span></code></pre></td></tr></table></div></div><p>and in the loop:</p><ul><li>the <strong>Data</strong> action, i.e., connecting to our file, from which we will read. We must remember to find the <strong>Skip count</strong> option in <strong>advanced mode</strong> and assign it a value from the <strong>skipToken</strong> variable. The easiest way to do this is as follows:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>variablem</span>(<span style=color:#e6db74>&#39;skipToken&#39;</span>)
</span></span></code></pre></div><ul><li>after the first loop, where we collected the first batch of data, we need to calculate the point at which we will start the next loop. So we increase the value of <strong>skipToken</strong> by another 5000.</li></ul><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>add</span>(<span style=color:#a6e22e>varaibles</span>(<span style=color:#e6db74>&#39;skipToken&#39;</span>), <span style=color:#ae81ff>5000</span>)
</span></span></code></pre></td></tr></table></div></div><ul><li>we don&rsquo;t want to lose the data collected in the current run, so we “send” it outside the loop - we combine what we currently have in resultArray with the data we have just obtained - <strong>MergeCurrentLoopWithResultsArray</strong></li></ul><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>union</span>(<span style=color:#a6e22e>variables</span>(<span style=color:#e6db74>&#39;resultArray), outputs(&#39;</span><span style=color:#a6e22e>newData</span><span style=color:#e6db74>&#39;)?[&#39;</span><span style=color:#a6e22e>body</span><span style=color:#960050;background-color:#1e0010>&#39;</span>])
</span></span></code></pre></td></tr></table></div></div><ul><li>and here is the correct dump to <strong>resultsArray</strong> from the <strong>UpdateResults</strong> step</li></ul><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>outputs</span>(<span style=color:#e6db74>&#39;MergeCurrentLoopWithResultsArray&#39;</span>)
</span></span></code></pre></td></tr></table></div></div><h1 id=what-else-is-worth-to-do>What else is worth to do?<a hidden class=anchor aria-hidden=true href=#what-else-is-worth-to-do>#</a></h1><p>I definitely recommend modifying the <strong>Timeout</strong> value for the <strong>Data</strong> step/action, i.e., where we refer to our <strong>Excel</strong> file.
Keep in mind that in this approach, we focused on loading >5000 <em>rows</em>, completely ignoring the number of columns, which can have a significant impact on data processing time.</p><p>How does it work?
<code>PT1H</code> is a standard ISO 8601 format meaning 1 hour (Period/Time: 1 Hour). It is used in Power Automate as the default timeout for the <em>Do until</em> loop - it means the maximum time the loop can run - after 1 hour, the operation ends automatically, even if the condition is not met (60 iterations OR PT1H by default).</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>PT10M</span>    <span style=color:#75715e>// 10 minutes testing
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>PT2H</span>     <span style=color:#75715e>// 2 hours production  
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>P1D</span>      <span style=color:#75715e>// 1 day (maximum for some actions)
</span></span></span></code></pre></td></tr></table></div></div><p>I recommend experimenting with this. <strong>PT2H</strong> seems to be safe for starters.</p><p>Also, remember to add a step at the end that will save our <strong>resultsArray</strong> to an <em>xlsx</em>, <em>csv</em>, or my favorite - <em>json</em> file, so that you don&rsquo;t lose your data and can continue working with it!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bgracz.github.io/tags/powerautomate/>Powerautomate</a></li><li><a href=https://bgracz.github.io/tags/dev/>Dev</a></li><li><a href=https://bgracz.github.io/tags/automation/>Automation</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://bgracz.github.io/>_techguy</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>